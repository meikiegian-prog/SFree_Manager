# SFree_Manager 版本更新日志

## 版本 1.1.1 - 2025-12-27

### 🔧 技术改进

#### 统计页面图表计算逻辑修正
- **占比显示优化**：时间分配图表从显示绝对小时数改为显示时间占比百分比
- **收入统计优化**：收入统计图表从显示绝对金额改为显示收入占比百分比
- **图表重新渲染修复**：解决切换统计维度时图表不更新的问题
- **数据一致性**：确保图表使用最新数据，避免闭包问题

#### 调试信息增强
- **详细调试**：添加收入数据详细检查，便于问题诊断
- **实时监控**：显示当前统计维度、有效项目数量、总数值等关键信息

### 📋 修改文件清单

#### pages/statistics/statistics.js (版本5-9)
- 修正图表数据计算逻辑：从绝对值改为占比显示
- 修复图表重新渲染机制：添加图表实例销毁和重新初始化
- 优化数据访问：在onInit回调内部重新获取最新数据
- 添加详细调试信息：便于监控图表数据变化

### 🎯 使用效果

- ✅ 统计图表正确按占比显示数据
- ✅ 切换时间分配/收入统计时图表正确更新
- ✅ 图表标题、tooltip、标签都正确反映占比信息
- ✅ 提供详细调试信息便于问题排查

---

## 版本 1.1.0 - 2025-12-25

### 🚀 新功能

#### 智能解析增强
- **扩展时间识别**：支持具体日期格式（YYYY-MM-DD HH:mm、MM月DD日 HH:mm等）
- **相对年份支持**：识别明年、后年、大后年等未来时间
- **纯数字修复**：修复"123"等纯数字被错误解析为时间的问题
- **时间合理性验证**：添加小时(0-23)和分钟(0-59)范围检查

#### 项目状态管理
- **自动停止追踪**：项目超时或完成时自动停止计时
- **智能状态同步**：确保追踪状态与项目状态保持一致
- **实时提醒**：超时时显示提示并温和震动

#### 界面优化
- **红色删除按钮**：超时/完成项目显示醒目的红色删除按钮
- **条件显示**：根据项目状态智能切换按钮显示
- **安全确认**：删除前弹出确认对话框，防止误操作

### 🔧 技术改进

#### 核心功能
- **智能解析算法**：多模式时间识别，按优先级顺序匹配
- **状态管理逻辑**：优化项目状态与追踪状态的同步机制
- **事件处理**：完善组件间事件传递和状态更新

#### 用户体验
- **视觉反馈**：红色按钮提供清晰的视觉标识
- **交互优化**：删除操作有安全确认机制
- **错误处理**：增强时间解析的健壮性

### 📋 修改文件清单

#### app.js (版本21-24)
- 增强智能解析功能
- 添加自动停止追踪逻辑
- 优化项目状态管理

#### components/project-card/ (版本25-27)
- 项目卡片WXML：添加删除按钮条件显示
- 项目卡片WXSS：添加红色删除按钮样式
- 项目卡片JS：添加删除项目功能

#### pages/index/ (版本28-29)
- 首页JS：添加删除项目事件处理
- 首页WXML：绑定删除项目事件

### 🎯 使用效果

- ✅ 智能解析支持更多自然语言时间表达
- ✅ 纯数字项目名称创建不再被错误解析
- ✅ 项目状态管理更加智能和自动化
- ✅ 超时/完成项目提供清晰的删除操作
- ✅ 删除操作有安全确认，避免误删

---

## 版本 1.0.0 - 2025-12-13

### 🚀 新功能

#### 基础功能
- **条件滑动功能**：项目内容超出显示范围时可上下滑动，不超出时无法滑动
- **快速记录面板**：点击触发，平时隐藏，不遮挡内容
- **智能布局**：自动适配不同屏幕尺寸和设备

### 🔧 技术改进

#### 页面结构优化
- **条件滑动**：项目数量超过3个时自动启用垂直滚动
- **智能判断**：项目较少时（≤3个）禁用滚动，保持原有布局
- **高度计算**：根据屏幕高度动态计算滚动容器高度

#### 交互体验
- **触发方式**：点击底部"+ 快速记录"按钮触发面板
- **显示逻辑**：面板显示时按钮消失，面板隐藏时按钮出现
- **动画效果**：平滑的上下滑动动画

### 📋 修改文件清单

#### pages/index/ (版本1-16)
- 首页WXML：添加scroll-view包装项目卡片列表
- 首页WXSS：添加滚动容器样式和底部按钮样式
- 首页JS：添加滚动高度计算和面板状态控制

#### components/record-panel/ (版本12-13)
- 记录面板：修改样式为完全隐藏，添加动画效果
- 交互优化：添加关闭按钮和动态class控制

### 🎯 使用效果

- ✅ 项目内容超出时可顺畅滑动查看
- ✅ 快速记录功能不干扰正常浏览
- ✅ 底部按钮直观易用
- ✅ 动画效果提升交互体验
- ✅ 适配各种屏幕尺寸

---

*最后更新: 2025-12-27*
*记录所有功能修改和优化内容*
